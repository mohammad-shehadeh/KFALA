<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒÙØ§Ù„Ø§Øª Ø§Ù„Ù…ØªØ·ÙˆØ±</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Tahoma', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            padding: 2rem;
            background: var(--primary-color);
            color: white;
            border-radius: 15px;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            min-width: 250px;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--secondary-color);
            color: white;
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .customer-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .customer-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
            position: relative;
        }

        .customer-card:hover {
            transform: translateY(-5px);
        }

        .card-header {
            border-bottom: 2px solid #eee;
            padding-bottom: 1rem;
            margin-bottom: 1rem;
        }

        .customer-id {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 0.5rem;
        }

        .status-indicator {
            position: absolute;
            top: 15px;
            left: 15px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .status-registered { background: #95a5a6; }
        .status-arrived { background: #f1c40f; }
        .status-completed { background: #2ecc71; }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .form-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
        }

        .days-counter {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--secondary-color);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
        }

        .customer-card {
    border: 2px solid #ccc;
    padding: 10px;
    margin: 10px 0;
    border-radius: 5px;
    transition: background 0.3s, border-color 0.3s;
}

.customer-card.received {
    background-color: #d4edda; /* Ù„ÙˆÙ† Ø£Ø®Ø¶Ø± ÙØ§ØªØ­ */
    border-color: #28a745; /* Ø£Ø®Ø¶Ø± ØºØ§Ù…Ù‚ */
}

@media print {
    body {
        width: 80mm;
        height: 40mm;
        margin: 0;
        padding: 0;
    }
}

    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© ÙƒÙØ§Ù„Ø§Øª Ø§Ù„Ù‡ÙˆØ§ØªÙ Ø§Ù„Ø°ÙƒÙŠØ©</h1>
            <p>Ø¥ØµØ¯Ø§Ø± 2.0 - Ù†Ø¸Ø§Ù… Ù…ØªÙƒØ§Ù…Ù„ Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØµÙŠØ§Ù†Ø©</p>
        </header>

        <div class="controls">
            <input type="text" class="search-box" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø£Ùˆ ID...">
            <button class="btn btn-primary" onclick="openRegistration()">
                <i class="fas fa-plus"></i>
                ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯
            </button>
            <button class="btn btn-success" onclick="exportToExcel()">
                <i class="fas fa-file-excel"></i>
                ØªØµØ¯ÙŠØ± Ù„Ù„Ø¥ÙƒØ³Ù„
            </button>
        </div>

        <div class="customer-cards" id="customerCards">
            <!-- Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù‡Ù†Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ -->
        </div>
    </div>

    <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ (Modal) -->
    <div id="registrationModal" class="modal">
        <div class="modal-content">
            <h2 style="margin-bottom: 1.5rem;">ØªØ³Ø¬ÙŠÙ„ ÙƒÙØ§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©</h2>
            <form id="registrationForm">
                <div class="form-group">
                    <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
                    <input type="text" class="form-input" id="customerName" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²</label>
                    <input type="text" class="form-input" id="deviceType" required>
                </div>

                <div class="form-group">
                    <label class="form-label">ÙˆØµÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©</label>
                    <textarea class="form-input" id="problemDescription" rows="3" required></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                    <input type="tel" class="form-input" id="customerPhone" required>
                </div>
                
                <!-- Ø­Ù‚Ù„ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… IMEI -->
                <div class="form-group">
                    <label class="form-label">Ø±Ù‚Ù… IMEI</label>
                    <input type="text" class="form-input" id="imeiNumber" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ù…ÙˆØ±Ø¯Ø©</label>
                    <select class="form-input" id="supplierCompany">
                        <option value="iCell">iCell</option>
                        <option value="Drive">Drive</option>
                        <option value="Telelink">Telelink</option>
                        <option value="CELL AVENUE">CELL AVENUE</option>
                        <option value="MORE TECH">MORE TECH</option>
                        <option value=" ">Ø£Ø®Ø±Ù‰</option>
                    </select>
                </div>

                <div class="form-group">
                    <button type="submit" class="btn btn-primary" style="width: 100%;">
                        <i class="fas fa-save"></i>
                        Ø­ÙØ¸ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // ØªÙˆÙ„ÙŠØ¯ Ù…Ø¹Ø±Ù ÙØ±ÙŠØ¯
        function generateID() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2, 5).toUpperCase();
        }
    
        // Ø¯Ø§Ù„Ø© Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø±ÙƒØ§Øª ÙˆØ§Ù„Ø¹Ù…Ù„ÙŠØ§Øª ÙÙŠ localStorage
        function logTransaction(action, details) {
            let transactions = JSON.parse(localStorage.getItem('transactions')) || [];
            transactions.push({
                timestamp: new Date().toLocaleString('ar-EG'),
                action: action,
                details: details
            });
            localStorage.setItem('transactions', JSON.stringify(transactions));
            console.log("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø±ÙƒØ©:", action, details);
        }
    
        // ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„
        function openRegistration() {
            document.getElementById('registrationModal').style.display = 'flex';
        }
    
        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù†Ø§ÙØ°Ø©
        window.onclick = function(event) {
            if (event.target.className === 'modal') {
                event.target.style.display = 'none';
            }
        }
    
        // Ø¯Ø§Ù„Ø© Ù„Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙÙŠ localStorage
        function saveCustomer(customerData) {
            let customers = JSON.parse(localStorage.getItem('customers')) || [];
            customers.push(customerData);
            localStorage.setItem('customers', JSON.stringify(customers));
            console.log("ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„:", customerData);
            logTransaction("ØªØ³Ø¬ÙŠÙ„ Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯", customerData);
        }
    
       // Ø¯Ø§Ù„Ø© Ù„Ø·Ø¨Ø§Ø¹Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø·Ø§Ø¨Ø¹Ø© Ø­Ø±Ø§Ø±ÙŠØ© (Ù…Ø­Ø§ÙƒØ§Ø©)
function printRegistration(customerData) {
    const printWindow = window.open('', '', 'width=280,height=160');

    printWindow.document.write('<html><head><title>Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„</title>');
    printWindow.document.write('<style>');
    printWindow.document.write(`
        body { 
            font-family: Arial, sans-serif; 
            font-size: 11px; 
            width: 80mm; 
            height: 40mm;
            margin: 0; 
            padding: 2mm;
            font-weight: bold; /* Ø¬Ø¹Ù„ ÙƒÙ„ Ø§Ù„Ù†ØµÙˆØµ Ø¹Ø±ÙŠØ¶Ø© */
        }
        .header { 
            text-align: left; /* ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„Ù†Øµ Ù„ÙŠØµØ¨Ø­ Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø± */
            margin-bottom: 2mm; 
            font-size: 20px;
        }
        .data { 
            margin-bottom: 2mm; 
            line-height: 1.5; 
        }
        .label {
            font-weight: bold;
        }
        hr {
            border: 0;
            border-top: 1px dashed #000;
            margin: 2px 0;
        }
    `);
    printWindow.document.write('</style>');
    printWindow.document.write('</head><body>');

    printWindow.document.write('<div class="header">Ø´Ø­Ø§Ø¯Ø© Ø³Ù†ØªØ±</div>');

    function formatDateTime(dateStr) {
        const date = new Date(dateStr);
        const day = date.getDate();
        const month = date.getMonth() + 1;
        const year = date.getFullYear();
        let hours = date.getHours();
        const minutes = date.getMinutes().toString().padStart(2, '0');
        const ampm = hours >= 12 ? 'Ù…' : 'Øµ';
        hours = hours % 12;
        hours = hours ? hours : 12; // Ø§Ù„Ø³Ø§Ø¹Ø© 0 ØªØµØ¨Ø­ 12
        return `${day}/${month}/${year}  ${hours}:${minutes}${ampm}`;
    }

    function printField(label, value) {
        printWindow.document.write('<div class="data">' + label + ':' + value + '</div>');
        printWindow.document.write('<hr>');
    }

    printField("name", customerData.name);
    printField("IMEI", customerData.imei);
    printField("model", customerData.device);
    printField("problem", customerData.problem);
    printField("phone", customerData.phone);
    printField("company", customerData.company);
    printField("DATE ", formatDateTime(customerData.registrationDate));

    printWindow.document.write('</body></html>');

    printWindow.document.close();
    printWindow.focus();
    printWindow.print();
    printWindow.close();

    logTransaction("Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„", customerData);
}

    
        // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¹Ù†Ø¯ ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
        document.getElementById('registrationForm').onsubmit = function(e) {
            e.preventDefault();
            
            const customerData = {
                id: generateID(),
                name: document.getElementById('customerName').value,
                device: document.getElementById('deviceType').value,
                problem: document.getElementById('problemDescription').value,
                phone: document.getElementById('customerPhone').value,
                imei: document.getElementById('imeiNumber').value,  // ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø±Ù‚Ù… IMEI
                company: document.getElementById('supplierCompany').value,
                status: 'ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„',
                registrationDate: new Date().toISOString(), // ÙŠØ¶Ù…Ù† ØªÙ†Ø³ÙŠÙ‚Ø§Ù‹ ØµØ§Ù„Ø­Ø§Ù‹
                daysCounter: 0
            };
    
            saveCustomer(customerData);
            createCustomerCard(customerData);
            document.getElementById('registrationModal').style.display = 'none';
            this.reset();
            
            // Ø·Ø¨Ø§Ø¹Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ù„Ù„Ø·Ø§Ø¨Ø¹Ø© Ø§Ù„Ø­Ø±Ø§Ø±ÙŠØ© 80 Ù…Ù…
            printRegistration(customerData);
        }
    
        // Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ¥Ø¶Ø§ÙØ© Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙƒØ®Ø§ØµÙŠØ© Ø¨ÙŠØ§Ù†Ø§Øª Ù„ØªØ³Ù‡ÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ù„Ø§Ø­Ù‚Ø§Ù‹
        function createCustomerCard(data) {
    // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© ØºÙŠØ± Ù…ÙƒØ±Ø±Ø©
    if (document.querySelector(`.customer-card[data-customer-id="${data.id}"]`)) {
        return;
    }

    const card = document.createElement('div');
    card.className = 'customer-card';
    card.setAttribute('data-customer-id', data.id); // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø±Ù Ø§Ù„Ø¹Ù…ÙŠÙ„
    card.innerHTML = `
        <div class="status-indicator status-${getStatusClass(data.status)}"></div>
        <div class="days-counter">${data.daysCounter} ÙŠÙˆÙ…</div>
        <div class="card-header">
            <div class="customer-id">ID: ${data.id}</div>
            <h3>${data.name}</h3>
            <p>${data.phone}</p>
        </div>
        <div class="card-body">
            <p><strong>Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²:</strong> ${data.device}</p>
            <p><strong>IMEI:</strong> ${data.imei}</p>
            <p><strong>Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:</strong> ${data.problem}</p>
            <p><strong>Ø§Ù„Ø´Ø±ÙƒØ©:</strong> ${data.company}</p>
            <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</strong> ${data.registrationDate}</p>
            <select class="status-select" onchange="updateStatus('${data.id}', this.value)">
                <option value="ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„" ${data.status === 'ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„' ? 'selected' : ''}>ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„</option>
                <option value="ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„" ${data.status === 'ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„' ? 'selected' : ''}>ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„</option>
                <option value="ØªÙ… Ø§Ù„Ø¥Ø³ØªÙ„Ø§Ù…" ${data.status === 'ØªÙ… Ø§Ù„Ø¥Ø³ØªÙ„Ø§Ù…' ? 'selected' : ''}>ØªÙ… Ø§Ù„Ø¥Ø³ØªÙ„Ø§Ù…</option>
            </select>
        </div>
    `;

    document.getElementById('customerCards').prepend(card);

    // ØªØ­Ø¯ÙŠØ« Ù„ÙˆÙ† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø­Ø§Ù„ØªÙ‡Ø§ "ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„"
    if (data.status === 'ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„') {
        card.classList.add('received');
    }
                // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ø¨Ø¹Ø¯ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
                updateDayCounters();

}

    
    
        // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„
        function updateStatus(customerId, newStatus) {
        let customers = JSON.parse(localStorage.getItem('customers')) || [];
        let customerIndex = customers.findIndex(c => c.id === customerId);
        
        if (customerIndex === -1) return;

        if (newStatus === 'ØªÙ… Ø§Ù„Ø¥Ø³ØªÙ„Ø§Ù…') {
            logTransaction("Ø­Ø°Ù Ø§Ù„Ø¹Ù…ÙŠÙ„", { customerId, reason: "ØªÙ… Ø§Ù„Ø¥Ø³ØªÙ„Ø§Ù…" });
            customers = customers.filter(c => c.id !== customerId);
            localStorage.setItem('customers', JSON.stringify(customers));

            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù…Ù† Ø§Ù„ØµÙØ­Ø©
            const card = document.querySelector(`.customer-card[data-customer-id="${customerId}"]`);
            if (card) card.remove();
            return;
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© ÙÙŠ localStorage
        customers[customerIndex].status = newStatus;
        localStorage.setItem('customers', JSON.stringify(customers));
        logTransaction("ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©", { customerId, newStatus });

        // ØªØ­Ø¯ÙŠØ« Ù„ÙˆÙ† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© ÙÙŠ Ø§Ù„ØµÙØ­Ø©
        const card = document.querySelector(`.customer-card[data-customer-id="${customerId}"]`);
        if (card) {
            if (newStatus === 'ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„') {
                card.classList.add('received');
            } else {
                card.classList.remove('received');
            }
        }

// Ø¥Ø±Ø³Ø§Ù„ SMS Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø© Ø¥Ù„Ù‰ "ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„"
if (newStatus === 'ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„') {
    const customer = customers[customerIndex];
    const message = `Ù…Ø±Ø­Ø¨Ù‹Ø§ ${customer.name}ØŒ\nØªÙ… ÙˆØµÙˆÙ„ Ø¬Ù‡Ø§Ø²Ùƒ Ù…Ù† Ø§Ù„Ø¶Ù…Ø§Ù†ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªÙ„Ø§Ù…Ù‡ ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª.\n\nğŸ“± Ø§Ù„Ø¬Ù‡Ø§Ø²: ${customer.device}\nğŸ”¢ IMEI: ${customer.imei}\nâš ï¸ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: ${customer.problem}\nğŸ“Œ Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${customerId}`;

    sendSMS(customer.phone, message);
}

        }
    

    // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©ØŒ ØªØ£ÙƒØ¯ Ù…Ù† ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„ØªÙŠ Ø­Ø§Ù„ØªÙ‡Ø§ "ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„"
    window.addEventListener('DOMContentLoaded', function() {
    let customers = JSON.parse(localStorage.getItem('customers')) || [];

    customers.forEach(customer => {
        if (!document.querySelector(`.customer-card[data-customer-id="${customer.id}"]`)) {
            createCustomerCard(customer);
        }

        // ØªØ­Ø¯ÙŠØ« Ù„ÙˆÙ† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø­Ø§Ù„ØªÙ‡Ø§ "ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„"
        const card = document.querySelector(`.customer-card[data-customer-id="${customer.id}"]`);
        if (card && customer.status === 'ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„') {
            card.classList.add('received');
        }
    });

    // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    updateDayCounters();
});

    
        // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© SMS ÙˆØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
        function sendSMS(phone, message) {
            const encodedMessage = encodeURIComponent(message);
            window.open(`sms:${phone}?body=${encodedMessage}`, '_blank');
            logTransaction("Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© SMS", { phone, message });
            console.log("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© SMS Ø¥Ù„Ù‰", phone);
        }
    
// ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… ÙÙŠ ÙƒÙ„ Ø¨Ø·Ø§Ù‚Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„
function updateDayCounters() {
    let customers = JSON.parse(localStorage.getItem('customers')) || [];
    const today = new Date(); // ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ…

    document.querySelectorAll('.customer-card').forEach(card => {
        const customerId = card.getAttribute('data-customer-id');
        let customer = customers.find(c => c.id === customerId);

        if (customer && customer.registrationDate) {
            let registrationDate = new Date(customer.registrationDate);

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„ØªØ§Ø±ÙŠØ®
            if (isNaN(registrationDate.getTime())) {
                console.warn(`âš ï¸ ØªØ§Ø±ÙŠØ® ØªØ³Ø¬ÙŠÙ„ ØºÙŠØ± ØµØ§Ù„Ø­ Ù„Ù„Ø¹Ù…ÙŠÙ„ ${customerId}:`, customer.registrationDate);
                return; // Ù„Ø§ ØªÙ‚Ù… Ø¨ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯
            }

            // Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ù…Ù†Ø° Ø§Ù„ØªØ³Ø¬ÙŠÙ„
            const daysPassed = Math.floor((today - registrationDate) / (1000 * 60 * 60 * 24));
            let daysElement = card.querySelector('.days-counter');
            daysElement.textContent = `${daysPassed} ÙŠÙˆÙ…`;

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙŠÙ…Ø© ÙÙŠ localStorage
            customer.daysCounter = daysPassed;
        }
    });

    localStorage.setItem('customers', JSON.stringify(customers));
}

    
        // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ù…Ù„Ù Ø¥ÙƒØ³Ù„ (ØªÙ†ÙÙŠØ° Ø§ÙØªØ±Ø§Ø¶ÙŠ)
        function exportToExcel() {
            alert('Ø³ÙŠØªÙ… ØªÙ†ÙÙŠØ° Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØµØ¯ÙŠØ± Ù„Ù„Ø¥ÙƒØ³Ù„ Ù‡Ù†Ø§');
            logTransaction("ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", { message: "ØªÙ… ØªÙ†ÙÙŠØ° ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ø¥ÙƒØ³Ù„" });
        }
    
        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ø§Ø³ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ø­Ø§Ù„Ø©
        function getStatusClass(status) {
            return status.replace(/ /g, '-').toLowerCase();
        }
    
        // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© ÙŠØªÙ… Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù…Ù† localStorage ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª
        window.addEventListener('DOMContentLoaded', function() {
            let customers = JSON.parse(localStorage.getItem('customers')) || [];
            customers.forEach(customer => {
                createCustomerCard(customer);
            });
        });
    
        // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… ÙŠÙˆÙ…ÙŠØ§Ù‹ (Ù…Ø­Ø§ÙƒØ§Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… setInterval)
        setInterval(updateDayCounters, 86400000);
    </script>
    
</body>
</html>
